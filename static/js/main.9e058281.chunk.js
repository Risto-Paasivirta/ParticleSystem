(this.webpackJsonpeditor=this.webpackJsonpeditor||[]).push([[0],Array(20).concat([function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),i=n(13),c=n.n(i),o=n(6),s=n(14),l=n(7),u=n(8),d=n(12),f=n.n(d),m=(n(20),n(21),n(22),n(23),n(24),n(0)),p=function(e){var t=e.value,n=e.name,a=e.propertyInfo,r=e.onChange,i=a.tooltip,c=a.min,o=a.max,s=a.step;return Object(m.jsxs)("div",{className:"number-layout field",children:[Object(m.jsx)("span",{className:"number-name",title:i,children:n}),Object(m.jsx)("input",{className:"number-field",type:"number",value:t,min:c,max:o,step:s,onChange:function(e){var t;try{t=Number(e.target.value)}catch(e){console.warn("NumberProperty could not parse Number")}r(t)}})]})},h=(n(26),function(e){var t=e.value,n=e.name,a=e.onChange;return Object(m.jsxs)("div",{className:"field position-div",children:[Object(m.jsx)("span",{title:n,children:n}),Object(m.jsxs)("div",{className:"position-child-div",children:[Object(m.jsx)("span",{children:"X"}),Object(m.jsx)("input",{className:"position-number-field",type:"number",value:t.x,step:10,onChange:function(e){var n;try{n=Number(e.target.value)}catch(e){console.warn("positionProperty could not parse Number (min)")}a({x:n,y:t.y})}})]}),Object(m.jsxs)("div",{className:"position-child-div",children:[Object(m.jsx)("span",{children:"Y"}),Object(m.jsx)("input",{className:"position-number-field",type:"number",value:t.y,step:10,onChange:function(e){var n;try{n=Number(e.target.value)}catch(e){console.warn("positionProperty could not parse Number (max)")}a({x:t.x,y:n})}})]})]})}),v=(n(27),function(e){var t=e.value,n=e.name,a=e.propertyInfo,r=e.onChange,i=a.tooltip,c=a.min,o=a.max,s=a.step;return Object(m.jsxs)("div",{className:"field range-div",children:[Object(m.jsx)("span",{title:i,children:n}),Object(m.jsxs)("div",{className:"range-child-div",children:[Object(m.jsx)("span",{children:"min"}),Object(m.jsx)("input",{className:"range-number-field",type:"number",value:t.min,min:c,max:o,step:s,onChange:function(e){var n;try{n=Number(e.target.value)}catch(e){console.warn("RangeProperty could not parse Number (min)")}r({min:n,max:t.max})}})]}),Object(m.jsxs)("div",{className:"range-child-div",children:[Object(m.jsx)("span",{children:"max"}),Object(m.jsx)("input",{className:"range-number-field",type:"number",value:t.max,min:c,max:o,step:s,onChange:function(e){var n;try{n=Number(e.target.value)}catch(e){console.warn("RangeProperty could not parse Number (max)")}r({min:t.min,max:n})}})]})]})}),b=(n(28),function(e){var t=e.value,n=e.name,a=e.onChange,r=function(e){return e>255?255:e<0?0:e};return Object(m.jsxs)("div",{className:"colorPalette-div field",children:[Object(m.jsx)("span",{children:n}),Object(m.jsxs)("div",{className:"colorPalette-nested-div",children:[t.length>0&&Object(m.jsxs)("table",{className:"colorPalette-table",children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"r"}),Object(m.jsx)("th",{children:"g"}),Object(m.jsx)("th",{children:"b"})]})}),Object(m.jsx)("tbody",{children:t.map((function(e,n){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:Object(m.jsx)("input",{className:"colorPalette-number-field",type:"number",value:255*e.r,min:0,max:255,step:1,onChange:function(e){var r;try{e.target.value>255&&(e.target.value=255),e.target.value<0&&(e.target.value=0),r=Number(e.target.value)/255}catch(e){console.warn("ColorPaletteProperty could not parse Number")}var i=Object(l.a)(t);i[n]=Object(o.a)(Object(o.a)({},i[n]),{},{r:r}),a(i)}})}),Object(m.jsx)("td",{children:Object(m.jsx)("input",{className:"colorPalette-number-field",type:"number",value:255*e.g,min:0,max:255,step:1,onChange:function(e){var i;try{i=r(Number(e.target.value))/255}catch(e){console.warn("ColorProperty could not parse Number")}var c=Object(l.a)(t);c[n]=Object(o.a)(Object(o.a)({},c[n]),{},{g:i}),a(c)}})}),Object(m.jsx)("td",{children:Object(m.jsx)("input",{className:"colorPalette-number-field",type:"number",value:255*e.b,min:0,max:255,step:1,onChange:function(e){var i;try{i=r(Number(e.target.value))/255}catch(e){console.warn("ColorProperty could not parse Number")}var c=Object(l.a)(t);c[n]=Object(o.a)(Object(o.a)({},c[n]),{},{b:i}),a(c)}})}),Object(m.jsx)("td",{children:Object(m.jsx)("div",{className:"colorPalette-remove-color",onClick:function(){var e=Object(l.a)(t);e.splice(n,1),a(e)}})})]},"row-color-".concat(n))}))})]}),Object(m.jsx)("div",{className:"colorPalette-add-color",onClick:function(){var e=[].concat(Object(l.a)(t),[{r:1,g:1,b:1}]);a(e)}})]})]})}),j=(n(29),function(e){var t=e.name,n=e.value,r=e.onChange,i=Object(a.useContext)(Ee).easingFunctions;return Object(m.jsxs)("div",{className:"easingFunction-div field",children:[Object(m.jsx)("span",{className:"easingFunction-name",children:t}),Object(m.jsx)("select",{className:"easingFunction-dropdown",value:n,onChange:function(e){var t=e.target.value;r(t)},children:i.map((function(e){return Object(m.jsx)("option",{className:"easingFunction-option",children:e},e)}))})]})}),y=(n(30),function(e){var t=e.value,n=e.name,r=e.onChange,i=Object(a.useContext)(Ee).shapes,c=i.find((function(e){return e.type===t.type}));return Object(m.jsxs)("div",{className:"shape-div field",children:[Object(m.jsxs)("div",{className:"shape-headerContainer",children:[Object(m.jsx)("span",{className:"shape-name",children:n}),Object(m.jsx)("select",{className:"shape-dropdown",value:t.type,onChange:function(e){var t=i.find((function(t){return t.type===e.target.value}));try{var n=JSON.parse(t.defaultValue);r(n)}catch(e){console.error("Error parsing shape @defaultValue: ".concat(t))}},children:i.map((function(e){return Object(m.jsx)("option",{className:"shape-option",children:e.type},e.type)}))})]}),Object(m.jsx)("div",{className:"shape-valuesContainer",children:Array.from(Object.entries(c)).filter((function(e){return"type"!==e[0]&&"defaultValue"!==e[0]})).map((function(e,n){return Object(m.jsx)(g,{name:e[0],value:t[e[0]],propertyInfo:{type:e[1]},onChange:function(n){var a=Object(o.a)({},t);a[e[0]]=n,r(a)}},"shape-value-".concat(n))}))})]})}),x=(n(31),function(e){var t=e.value,n=e.name,a=e.onChange;return Object(m.jsxs)("div",{className:"burstListProperty-div field",children:[Object(m.jsx)("span",{children:n}),Object(m.jsxs)("div",{className:"burstListProperty-nested-div",children:[t.length>0&&Object(m.jsxs)("table",{className:"burstListProperty-table",children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"time"}),Object(m.jsx)("th",{children:"count"}),Object(m.jsx)("th",{children:"repeat"})]})}),Object(m.jsx)("tbody",{children:t.sort((function(e,t){return e.time-t.time})).map((function(e,n){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:Object(m.jsx)("input",{className:"burstListProperty-number-field",type:"number",value:e.time,min:0,step:.5,onChange:function(e){var r;try{r=Number(e.target.value)}catch(e){console.warn("BurstListProperty could not parse Number")}var i=Object(l.a)(t);i[n]=Object(o.a)(Object(o.a)({},i[n]),{},{time:r}),a(i)}})}),Object(m.jsx)("td",{children:Object(m.jsx)("input",{className:"burstListProperty-number-field",type:"number",value:e.count,min:0,step:10,onChange:function(e){var r;try{r=Number(e.target.value)}catch(e){console.warn("BurstListProperty could not parse Number")}var i=Object(l.a)(t);i[n]=Object(o.a)(Object(o.a)({},i[n]),{},{count:r}),a(i)}})}),Object(m.jsx)("td",{children:Object(m.jsx)("input",{className:"burstListProperty-number-field",type:"number",value:void 0!==e.repeat?e.repeat:0,min:0,step:.5,onChange:function(e){var r;try{0===(r=Number(e.target.value))&&(r=void 0)}catch(e){console.warn("BurstListProperty could not parse Number")}var i=Object(l.a)(t);i[n]=Object(o.a)(Object(o.a)({},i[n]),{},{repeat:r}),a(i)}})}),Object(m.jsx)("td",{children:Object(m.jsx)("div",{className:"burstListProperty-remove-burst",onClick:function(){var e=Object(l.a)(t);e.splice(n,1),a(e)}})})]},"burst-row-".concat(n))}))})]}),Object(m.jsx)("div",{className:"burstListProperty-add-burst",onClick:function(){var e=[].concat(Object(l.a)(t),[{time:0,count:20,repeat:void 0}]);a(e)}})]})]})}),O=(n(32),function(e){var t=e.value,n=e.name,a=e.onChange;return Object(m.jsxs)("div",{className:"boolean-div field",children:[Object(m.jsx)("span",{children:n}),Object(m.jsx)("input",{className:"boolean-field",checked:t,type:"checkbox",onChange:function(e){a(e.target.checked)}})]})}),g=function(e){var t=e.propertyInfo;switch(t.type&&t.type.toLowerCase()){case"number":return Object(m.jsx)(p,Object(o.a)({},e));case"position":return Object(m.jsx)(h,Object(o.a)({},e));case"range":return Object(m.jsx)(v,Object(o.a)({},e));case"color[]":return Object(m.jsx)(b,Object(o.a)({},e));case"easingfunction":return Object(m.jsx)(j,Object(o.a)({},e));case"shape":return Object(m.jsx)(y,Object(o.a)({},e));case"burst[]":return Object(m.jsx)(x,Object(o.a)({},e));case"boolean":return Object(m.jsx)(O,Object(o.a)({},e));default:throw new Error("Unidentified module property type: ".concat(t.type))}},T=function(e){var t=e.module,n=e.nKey,r=e.updateModule,i=e.removeModule,c=e.moveModuleUp,s=e.moveModuleDown,l=Object(a.useContext)(Ee).particleModules,d=l.find((function(e){return e.moduleTypeId===t.moduleTypeId}));if(!d)throw new Error("Unidentified module: ".concat(t.moduleTypeId));var f=Array.from(new Set(l.map((function(e){return e.category})))).filter((function(e){return void 0!==e}));return Object(m.jsxs)("div",{className:"module",children:[Object(m.jsxs)("div",{className:"module-title-layout field",children:[Object(m.jsx)("select",{className:"module-typeDropdown",value:t.moduleTypeId,onChange:function(e){var t=e.target.value;r({moduleTypeId:t})},children:f.sort((function(e,t){return e.localeCompare(t)})).map((function(e,t){return Object(m.jsx)("optgroup",{label:e,children:l.filter((function(t){return t.category===e})).map((function(e,t){return Object(m.jsx)("option",{value:e.moduleTypeId,children:e.moduleTypeId},"option-".concat(t))}))},"module-".concat(t))}))}),Object(m.jsxs)("div",{className:"module-moveContainer",children:[Object(m.jsx)("div",{className:"module-move module-moveUp",title:"Move module up",onClick:function(){c()}}),Object(m.jsx)("div",{className:"module-move module-moveDown",title:"Move module down",onClick:function(){s()}})]}),Object(m.jsx)("div",{className:"module-remove",onClick:function(){return i()}})]}),Object(m.jsx)("div",{className:"module-properties",children:Object.entries(d.properties).map((function(e,a){var i=Object(u.a)(e,2),c=i[0],s=i[1];return Object(m.jsx)(g,{name:c,value:t[c],propertyInfo:s,onChange:function(e){var n=Object(o.a)({},t);n[c]=e,r(n)}},"".concat(n,"_property").concat(a))}))})]})},P=(n(33),function(e){var t=e.selectedTextures,n=e.updateTextures,r=Object(a.useContext)(Ee).availableTextures;return Object(m.jsx)("select",{className:"textureSelector-dropdown field",onChange:function(e){var t=e.target.value;n([t])},value:t[0],children:r.sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e,t){return Object(m.jsx)("option",{className:"textureSelector-option",children:e},"texture-".concat(t))}))})}),E=function(e){var t=e.effect,n=e.title,r=e.nKey,i=e.updateEffect,c=e.removeEffect,s=Object(a.useContext)(Ee).particleModules;return Object(m.jsxs)("div",{className:"effect",children:[Object(m.jsxs)("div",{className:"effect-titleDiv",children:[Object(m.jsx)("span",{className:"effect-title",children:n}),Object(m.jsx)("div",{className:"effect-remove",onClick:function(){c()}})]}),Object(m.jsxs)("div",{className:"effect-properties",children:[Object(m.jsx)(P,{selectedTextures:t.textures,updateTextures:function(e){var n=Object(o.a)(Object(o.a)({},t),{},{textures:e});i(n)}}),Object(m.jsxs)("div",{className:"effect-addModuleDiv field",onClick:function(){var e={moduleTypeId:s[0].moduleTypeId},n=Object(o.a)({},t);n.modules.unshift(e),i(n)},children:[Object(m.jsx)("div",{className:"effect-addModule"}),Object(m.jsx)("span",{children:"Add module"})]}),t.modules.map((function(e,n){return Object(m.jsx)(T,{module:e,nKey:"".concat(r,"_module").concat(n),updateModule:function(e){var a=Object(o.a)({},t);a.modules[n]=e,i(a)},removeModule:function(){var n=Object(o.a)({},t);n.modules.splice(n.modules.indexOf(e),1),i(n)},moveModuleUp:function(){if(!(n<=0)){var a=Object(o.a)({},t);a.modules.splice(n,1),a.modules.splice(n-1,0,e),i(a)}},moveModuleDown:function(){if(!(n>=t.modules.length-1)){var a=Object(o.a)({},t);a.modules.splice(n,1),a.modules.splice(n+1,0,e),i(a)}}},"".concat(r,"_module").concat(n))}))]})]})},N=function(e){var t=e.effects,n=e.updateEffects;return Object(m.jsxs)("div",{className:"effectsConfigurationPanel",children:[Object(m.jsxs)("div",{className:"effectsConfigurationPanel-addDiv field",onClick:function(){var e=Object(l.a)(t);e.unshift({textures:["ball.png"],modules:[]}),n(e)},children:[Object(m.jsx)("div",{className:"effectsConfigurationPanel-add"}),"Add effect"]}),Object(m.jsx)("span",{className:"effectsConfigurationPanel-titleEffects"}),t.map((function(e,a){return Object(m.jsx)(E,{effect:e,title:"Effect ".concat(a+1),nKey:"effect".concat(a),updateEffect:function(e){var r=Object(l.a)(t);r[a]=e,n(r)},removeEffect:function(){var a=Object(l.a)(t);a.splice(a.indexOf(e),1),n(a)}},"effect".concat(a))})),Object(m.jsx)("div",{className:"effectsConfigurationPanel-footer"})]})},M=(n(34),function(e){var t=e.restart,n=e.saveToFile,r=e.loadFromFile,i=e.loadPreset,c=Object(a.useContext)(Ee).presetEffects,o=Object(a.useState)(!1),s=Object(u.a)(o,2),l=s[0],d=s[1];return Object(m.jsxs)("div",{className:"projectToolbar",children:[Object(m.jsx)("div",{className:"projectToolbar-gap"}),Object(m.jsxs)("div",{className:"projectToolBar-buttons",children:[Object(m.jsx)("div",{className:"projectToolbar-buttonDiv projectToolbar-restart",onClick:function(){return t()},children:Object(m.jsx)("span",{className:"projectToolbar-button",children:"Restart"})}),Object(m.jsx)("div",{className:"projectToolbar-buttonDiv projectToolbar-saveToFile",onClick:function(){return n()},children:Object(m.jsx)("span",{className:"projectToolbar-button",children:"Save to file"})}),Object(m.jsxs)("div",{className:"projectToolbar-buttonDiv projectToolbar-loadPreset",onClick:function(){d(!l)},children:[Object(m.jsx)("span",{className:"projectToolbar-button",children:"Load preset"}),Object(m.jsx)("div",{className:"projectToolbar-preset-container".concat(l?" projectToolbar-preset-container-visible":""),children:l&&c.map((function(e,t){return Object(m.jsxs)("div",{className:"projectToolBar-preset-item",onClick:function(){i(e.data),d(!1)},children:[Object(m.jsx)("div",{className:"projectToolBar-preset-thumbnail",style:{backgroundImage:e.thumbnail&&"url(presetThumbnails/".concat(e.thumbnail,")")}}),Object(m.jsx)("span",{className:"projectToolBar-preset-label",children:e.label})]},"preset-".concat(t))}))})]}),Object(m.jsx)("div",{className:"projectToolbar-buttonDiv projectToolbar-loadFromFile",onClick:function(){return r()},children:Object(m.jsx)("span",{className:"projectToolbar-button",children:"Load from file"})})]}),Object(m.jsx)("div",{className:"projectToolbar-gap"})]})}),A=(n(35),"pixels"),w={autoUpdate:!0,maxParticlesCount:5e4,loggingEnabled:!0,coordinateSystem:A},I=function(e){var t=Object.assign({},w,e),n=t.particleSystem,a=t.container,r=t.textures,i=t.autoUpdate,c=t.maxParticlesCount,o=t.loggingEnabled,s=t.coordinateSystem;if(!n)throw new Error("particleSystem parameter must be supplied!");if(!a)throw new Error("container parameter must be supplied!");var l=document.createElement("canvas");l.style.position="absolute",l.style.left="0px",l.style.top="0px",a.append(l);var u=l.getContext("webgl2"),d="#version 300 es\n  precision mediump float;\n  precision mediump int;\n  layout(location=".concat(0,") in vec2 aPosGeometry;\n  layout(location=").concat(1,") in vec2 aTexCoord;\n  layout(location=").concat(2,") in vec2 aPos;\n  layout(location=").concat(3,") in vec4 aColor;\n  layout(location=").concat(4,") in float aRotationRad;\n  layout(location=").concat(5,") in float aScale;\n  uniform vec2 uViewportSizePx;\n  uniform sampler2D uTexture;\n  out vec4 vColor;\n  out vec2 vTexCoord;\n  void main(void) {\n    ivec2 size = textureSize(uTexture, 0);\n    float rotX = cos(aRotationRad);\n    float rotY = sin(aRotationRad);\n    vec2 rotGeometry = vec2(\n      aPosGeometry.x * rotY + aPosGeometry.y * rotX,\n      aPosGeometry.y * rotY - aPosGeometry.x * rotX\n    );\n    ").concat(s===A?"gl_Position = vec4(vec2(-1.0, 1.0) + (vec2(aPos.x, -aPos.y) + rotGeometry * vec2(size) * aScale) * 2.0 / uViewportSizePx, 0.0, 1.0);":"pixels-centered"===s?"gl_Position = vec4((vec2(aPos.x, -aPos.y) + rotGeometry * vec2(size) * aScale) * 2.0 / uViewportSizePx, 0.0, 1.0);":(console.error("Unidentified 'coordinateSystem': ".concat(s)),""),"\n    vColor = aColor;\n    vTexCoord = aTexCoord;\n  }"),f="number"===typeof c&&c>0?8*c:Number.MAX_SAFE_INTEGER;u.enable(u.BLEND),u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);var m=u.createShader(u.VERTEX_SHADER);if(u.shaderSource(m,d),u.compileShader(m),!u.getShaderParameter(m,u.COMPILE_STATUS)){var p=u.getShaderInfoLog(m);console.error("Vertex shader compilation error\n".concat(p))}var h=u.createShader(u.FRAGMENT_SHADER);if(u.shaderSource(h,"#version 300 es\n  precision mediump float;\n  precision mediump int;\n  in vec4 vColor;\n  in vec2 vTexCoord;\n  uniform sampler2D uTexture;\n  out vec4 fragColor;\n  void main(void) {\n    vec4 texSample = texture(uTexture, vTexCoord);\n    fragColor = vec4(vColor.rgb, vColor.a * texSample.a);\n  }"),u.compileShader(h),!u.getShaderParameter(h,u.COMPILE_STATUS)){var v=u.getShaderInfoLog(h);console.error("Fragment shader compilation error\n".concat(v))}var b=u.createProgram();u.attachShader(b,m),u.attachShader(b,h),u.linkProgram(b),u.getProgramParameter(b,u.LINK_STATUS)||console.error("Shader program link error\n".concat(u.getProgramInfoLog(b))),u.deleteShader(m),u.deleteShader(h),u.useProgram(b);var j=u.getUniformLocation(b,"uViewportSizePx"),y=u.getUniformLocation(b,"uTexture"),x=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,x),u.bufferData(u.ARRAY_BUFFER,new Float32Array([-.5,-.5,0,0,-.5,.5,0,1,.5,.5,1,1,.5,-.5,1,0]),u.STATIC_DRAW),u.enableVertexAttribArray(0),u.vertexAttribDivisor(0,0),u.vertexAttribPointer(0,2,u.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),u.enableVertexAttribArray(1),u.vertexAttribDivisor(1,0),u.vertexAttribPointer(1,2,u.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT);var O=u.createBuffer(),g=1e4,T=new Float32Array(g);u.bindBuffer(u.ARRAY_BUFFER,O),u.bufferData(u.ARRAY_BUFFER,T,u.STREAM_DRAW);var P=[];r&&Object.keys(r).forEach((function(e){var t=r[e];if(t){o&&console.time("load texture ".concat(e));try{var a=function(t){var a=P.length,r=u.createTexture();u.activeTexture(u.TEXTURE0+a),u.bindTexture(u.TEXTURE_2D,r),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);var i=u.RGBA,c=u.RGBA,s=u.UNSIGNED_BYTE;u.texImage2D(u.TEXTURE_2D,0,i,c,s,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),P.push({texture:r,index:a,name:e}),o&&console.timeEnd("load texture ".concat(e));var l=void 0;n.effects.forEach((function(e){e.textures.forEach((function(e){var t=P.findIndex((function(t){return t.name===e}));t>=0&&(l=t)}))})),l>=0&&u.uniform1i(y,l)};if(t instanceof HTMLImageElement)if(t.complete)a(t);else{t.addEventListener("load",(function e(){a(t),t.removeEventListener("load",e)}))}else a(t)}catch(i){console.error("Couldn't load texture ".concat(e,"\n\t").concat(i.message))}}}));n.update(0);var E=window.performance.now(),N=void 0,M=0;N=requestAnimationFrame((function e(){var t=window.performance.now();if(i){var r=Math.min(t-E,1e4);n.update(r/1e3)}var c=n.effects.reduce((function(e,t){return e+t.particles.length}),0);0===M&&0===c||function(){var e=a.getBoundingClientRect(),t=Math.floor(e.width),r=Math.floor(e.height);l.width=t,l.height=r,l.style.width="".concat(t,"px"),l.style.height="".concat(r,"px"),u.viewport(0,0,t,r),u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT);var i=n.effects.map((function(e){return e.particles})).flat(),c=i.length,s=8*c;if(s>g&&g<f){var d=Math.max(s,2*g);d>f&&(console.warn("Maximum particle data buffer size exceeded - some particles might not be rendered!"),d=f),o&&console.info("Increasing particle data buffer size ".concat(g," -> ").concat(d)),T=new Float32Array(d),g=d}for(var m=Math.min(c,g/8),p=0;p<m;p+=1){var h=i[p],v=8*p;T[v+0]=h.position.x,T[v+1]=h.position.y,T[v+2]=h.color.r,T[v+3]=h.color.g,T[v+4]=h.color.b,T[v+5]=h.alpha,T[v+6]=h.rotation,T[v+7]=h.scale}u.uniform2f(j,t,r),u.bufferData(u.ARRAY_BUFFER,T,u.STREAM_DRAW),u.enableVertexAttribArray(2),u.vertexAttribDivisor(2,1),u.vertexAttribPointer(2,2,u.FLOAT,!1,8*Float32Array.BYTES_PER_ELEMENT,0*Float32Array.BYTES_PER_ELEMENT),u.enableVertexAttribArray(3),u.vertexAttribDivisor(3,1),u.vertexAttribPointer(3,4,u.FLOAT,!1,8*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),u.enableVertexAttribArray(4),u.vertexAttribDivisor(4,1),u.vertexAttribPointer(4,1,u.FLOAT,!1,8*Float32Array.BYTES_PER_ELEMENT,6*Float32Array.BYTES_PER_ELEMENT),u.enableVertexAttribArray(5),u.vertexAttribDivisor(5,1),u.vertexAttribPointer(5,1,u.FLOAT,!1,8*Float32Array.BYTES_PER_ELEMENT,7*Float32Array.BYTES_PER_ELEMENT),u.drawArraysInstanced(u.TRIANGLE_FAN,0,4,m)}(),E=t,M=c,N=requestAnimationFrame(e)}));var I=!1;return{destroy:function(){I||(I=!0,N&&(cancelAnimationFrame(N),N=void 0,a.removeChild(l)),u.deleteProgram(b),u.deleteBuffer(x),u.deleteBuffer(O),P.forEach((function(e){u.deleteTexture(e.texture)})))}}},S=n(1),C=n(2),R=n(5),L=n(4),k=function(){function e(t){Object(S.a)(this,e),this.active=!0,this.particleEffect=t}return Object(C.a)(e,[{key:"init",value:function(){}},{key:"update",value:function(e){}}]),e}(),_=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"update",value:function(e){for(var t=this.particleEffect.particles.length,n=0;n<t;n+=1){var a=this.particleEffect.particles[n];a.alpha<=0&&this.particleEffect.destroyParticle(a)}}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId}}}],[{key:"fromObject",value:function(e,t,a){return new n(e)}}]),n}(k);_.moduleTypeId="AlphaDestructor";var F=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"update",value:function(e){for(var t=this.particleEffect.particles.length,n=0;n<t;n+=1){var a=this.particleEffect.particles[n];a.timeLived>=a.lifeTime&&this.particleEffect.destroyParticle(a)}}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId}}}],[{key:"fromObject",value:function(e,t,a){return new n(e)}}]),n}(k);F.moduleTypeId="LifeTimeDestructor";var D=function(e,t,n,a,r,i){var c=e[a];if(void 0!==c){var o=r(c);void 0!==o?n[a]=o:i||console.warn("Module property could not be deserialized ".concat(t.moduleTypeId,': "').concat(a,'"'))}else i||console.warn("Missing module property ".concat(t.moduleTypeId,': "').concat(a,'"'))},B=function(e){return e},U=function(e,t,n){return e*(1-n)+t*n},V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(n,Math.max(t,e))},Y=function(e,t){return e+Math.random()*(t-e)},G={subtract:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},multiply:function(e,t){return{x:e.x*t,y:e.y*t}},length:function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},normalize:function(e){var t=G.length(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},lengthBetween:function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},X=function(e,t,n){var a=z(e),r=z(t),i={l:U(a.l,r.l,n),a:U(a.a,r.a,n),b:U(a.b,r.b,n)},c=H(i);return{r:c.r,g:c.g,b:c.b}},z=function(e){var t,n,a,r=e.r,i=e.g,c=e.b;return n=(.2126*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.7152*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.0722*(c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92))/1,a=(.0193*r+.1192*i+.9505*c)/1.08883,t=(t=(.4124*r+.3576*i+.1805*c)/.95047)>.008856?Math.pow(t,1/3):7.787*t+16/116,{l:116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,a:500*(t-n),b:200*(n-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))}},H=function(e){var t,n,a,r=(e.l+16)/116,i=e.a/500+r,c=r-e.b/200;return n=-.9689*(i=.95047*(i*i*i>.008856?i*i*i:(i-16/116)/7.787))+1.8758*(r=1*(r*r*r>.008856?r*r*r:(r-16/116)/7.787))+.0415*(c=1.08883*(c*c*c>.008856?c*c*c:(c-16/116)/7.787)),a=.0557*i+-.204*r+1.057*c,t=(t=3.2406*i+-1.5372*r+-.4986*c)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:12.92*a,{r:Math.max(0,Math.min(1,t)),g:Math.max(0,Math.min(1,n)),b:Math.max(0,Math.min(1,a))}},q={getRandomPosition:function(e){var t=2*Math.random()*Math.PI,n=Math.sqrt(Math.random())*e.radius;return{x:e.center.x+Math.cos(t)*n,y:e.center.y+Math.sin(t)*n}},getRandomEdgePosition:function(e){var t=2*Math.random()*Math.PI,n=e.radius;return{x:e.center.x+Math.cos(t)*n,y:e.center.y+Math.sin(t)*n}},containsPosition:function(e,t){return G.length(G.subtract(t,e.center))<=e.radius}},W={getRandomPosition:function(e){return{x:e.v1.x+Math.random()*(e.v2.x-e.v1.x),y:e.v1.y+Math.random()*(e.v2.y-e.v1.y)}},getRandomEdgePosition:function(e){var t=Math.abs(e.v1.x-e.v2.x),n=Math.abs(e.v1.y-e.v2.y),a=Y(0,2*t+2*n);return a<n?{x:e.v1.x,y:e.v1.y+a}:a<t+n?{x:e.v1.x+a-n,y:e.v1.y+n}:a<2*n+t?{x:e.v1.x+t,y:e.v1.y+a-(n+t)}:{x:e.v1.x+a-(2*n+t),y:e.v1.y}},containsPosition:function(e,t){var n=Math.min(e.v1.x,e.v2.x),a=Math.min(e.v1.y,e.v2.y),r=Math.max(e.v1.x,e.v2.x),i=Math.max(e.v1.y,e.v2.y);return t.x>=n&&t.x<=r&&t.y>=a&&t.y<=i}},K={getRandomPosition:function(e){var t=Math.random(),n=Math.random(),a=Math.sqrt(t);return{x:e.v1.x*(1-a)+e.v2.x*(1-n)*a+e.v3.x*n*a,y:e.v1.y*(1-a)+e.v2.y*(1-n)*a+e.v3.y*n*a}},containsPosition:function(e,t){var n=J(t,e.v1,e.v2),a=J(t,e.v2,e.v3),r=J(t,e.v3,e.v1);return!((n<0||a<0||r<0)&&(n>0||a>0||r>0))},getRandomEdgePosition:function(e){var t=G.lengthBetween(e.v1,e.v2),n=G.lengthBetween(e.v2,e.v3),a=G.lengthBetween(e.v3,e.v1),r=Y(0,t+n+a),i=function(e,t,n,a){var r=a/n;return{x:e.x+(t.x-e.x)*r,y:e.y+(t.y-e.y)*r}};return r<t?i(e.v1,e.v2,t,r):r<t+n?i(e.v2,e.v3,n,r-t):i(e.v3,e.v1,a,r-t-n)}},J=function(e,t,n){return(e.x-n.x)*(t.y-n.y)-(t.x-n.x)*(e.y-n.y)},Q=function(e){return e},Z=function(e){switch(e.type){case"triangle":return K;case"rectangle":return W;case"circle":return q}},$=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"update",value:function(e){var t,n,a=this.particleEffect.particles.length;if(this.bounds)for(var r=0;r<a;r+=1){var i=this.particleEffect.particles[r];t=this.bounds,n=i.position,Z(t).containsPosition(t,n)||this.particleEffect.destroyParticle(i)}}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,bounds:this.bounds&&this.bounds}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"bounds",Q,a),r}}]),n}(k);$.moduleTypeId="OutsideBoundsDestructor";var ee=Object(C.a)((function e(){Object(S.a)(this,e),this.position={x:0,y:0},this.velocity={x:0,y:0},this.color={r:1,g:1,b:1},this.alpha=1,this.rotation=0,this.rotationalVelocity=0,this.timeLived=0,this.lifeTime=2,this.scale=.1,this.destroyed=!1,this.texture=""})),te=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).interval=.1,e._timer=0,e.bursts=[],e._updateCounter=0,e}return Object(C.a)(n,[{key:"update",value:function(e){var t=this,n=this._updateCounter,a=this._updateCounter+e;if(this.bursts.forEach((function(e){var r=void 0===e.repeat||e.repeat<=0||e.time>n?e.time:e.time+e.repeat*Math.ceil((n-e.time)/e.repeat);if(r>=n&&r<=a)for(var i=0;i<e.count;i+=1)t.generateParticle()})),this._updateCounter=a,!(this.interval<=0))for(this._timer+=e;this._timer>=this.interval;)this._timer-=this.interval,this.generateParticle()}}]),n}(k),ne=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).position={x:0,y:0},e}return Object(C.a)(n,[{key:"generateParticle",value:function(){var e=new ee;e.position.x=this.position.x,e.position.y=this.position.y,this.particleEffect.addParticle(e)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,interval:this.interval,bursts:this.bursts,position:this.position}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"interval",B,a),D(t,n,r,"bursts",B,a),D(t,n,r,"position",B,a),r}}]),n}(te);ne.moduleTypeId="PointGenerator";var ae=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).min=0,e.max=1,e.handleParticleAdd=function(t){t.alpha=Y(e.min,e.max)},e}return Object(C.a)(n,[{key:"init",value:function(){this.active=!1,this.particleEffect.addParticleListeners.push(this.handleParticleAdd)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,min:this.min,max:this.max}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"min",B,a),D(t,n,r,"max",B,a),r}}]),n}(k);ae.moduleTypeId="AlphaRange";var re=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).min=1.5,e.max=2.5,e.handleParticleAdd=function(t){t.lifeTime=U(e.min,e.max,Math.random())},e}return Object(C.a)(n,[{key:"init",value:function(){this.active=!1,this.particleEffect.addParticleListeners.push(this.handleParticleAdd)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,min:this.min,max:this.max}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"min",B,a),D(t,n,r,"max",B,a),r}}]),n}(k);re.moduleTypeId="LifeTimeRange";var ie=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).min=0,e.max=100,e.handleParticleAdd=function(t){var n=2*Math.random()*Math.PI,a=Y(e.min,e.max);t.velocity.x=Math.cos(n)*a,t.velocity.y=Math.sin(n)*a},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,min:this.min,max:this.max}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"min",B,a),D(t,n,r,"max",B,a),r}}]),n}(k);ie.moduleTypeId="RandomAngleVelocity";var ce=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).min=.5,e.max=1.5,e.handleParticleAdd=function(t){t.scale=U(e.min,e.max,Math.random())},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd),this.active=!1}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,min:this.min,max:this.max}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"min",B,a),D(t,n,r,"max",B,a),r}}]),n}(k);ce.moduleTypeId="RandomScale";var oe=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).palette=[{r:1,g:0,b:0},{r:0,g:1,b:0},{r:0,g:0,b:1}],e.interpolate=!0,e.handleParticleAdd=function(t){if(e.interpolate&&e.palette.length>=2){var n=Math.random()*(e.palette.length-1),a=Math.floor(n),r=e.palette[a],i=e.palette[a+1];t.color=X(r,i,n-a)}else e.palette.length>=1&&(t.color=e.palette[Math.round(Math.random()*(e.palette.length-1))])},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd),this.active=!1}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,palette:this.palette,interpolate:this.interpolate}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"palette",B,a),D(t,n,r,"interpolate",B,a),r}}]),n}(k);oe.moduleTypeId="RandomColor";var se=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).min=-2*Math.PI,e.max=2*Math.PI,e.handleParticleAdd=function(t){t.rotationalVelocity=U(e.min,e.max,Math.random())},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd),this.active=!1}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,min:this.min,max:this.max}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"min",B,a),D(t,n,r,"max",B,a),r}}]),n}(k);se.moduleTypeId="RandomRotationalVelocity";var le=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).randomX={min:-100,max:100},e.randomY={min:-100,max:100},e.handleParticleAdd=function(t){t.velocity.x=U(e.randomX.min,e.randomX.max,Math.random()),t.velocity.y=U(e.randomY.min,e.randomY.max,Math.random())},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,randomX:this.randomX,randomY:this.randomY}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"randomX",B,a),D(t,n,r,"randomY",B,a),r}}]),n}(k);le.moduleTypeId="RandomVelocity";var ue={linear:function(e){return e},easeOutSine:function(e){return Math.sin(e*Math.PI/2)},easeOutCubic:function(e){return 1-Math.pow(1-e,3)},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeOutBack:function(e){var t=1.70158;return 1+2.70158*Math.pow(e-1,3)+t*Math.pow(e-1,2)},easeOutElastic:function(e){var t=2*Math.PI/3;return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*t)+1}},de=function(e){var t=Object.entries(ue).find((function(t){return t[1]===e}));if(!t)throw new Error("serializeEasing supplied value is not an EasingFunction");return t[0]},fe=function(e){if("string"===typeof e){var t=Object.entries(ue).find((function(t){return t[0]===e}));return t?t[1]:void 0}},me=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).easing=ue.easeOutSine,e.handleParticleAdd=function(e){e._alphaOverLifetime_initialAlpha=e.alpha},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd)}},{key:"update",value:function(e){for(var t=this.particleEffect.particles,n=t.length,a=0;a<n;a+=1){var r=t[a],i=r._alphaOverLifetime_initialAlpha,c=i-i*this.easing(V(r.timeLived/r.lifeTime,0,1));r.alpha=c}}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,easing:de(this.easing)}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"easing",fe,a),r}}]),n}(k);me.moduleTypeId="AlphaOverLifetime";var pe=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).easing=ue.easeOutSine,e.handleParticleAdd=function(e){e._velocityOverLifetime_initialVelocity={x:e.velocity.x,y:e.velocity.y}},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd)}},{key:"update",value:function(e){for(var t=this.particleEffect.particles,n=t.length,a=0;a<n;a+=1){var r=t[a],i=(r.timeLived-e)/r.lifeTime,c=r.timeLived/r.lifeTime,o=this.easing(i),s=this.easing(c),l=r._velocityOverLifetime_initialVelocity,u=G.multiply(l,s-o);r.velocity.x-=u.x,r.velocity.y-=u.y}}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,easing:fe(this.easing)}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"easing",fe,a),r}}]),n}(k);pe.moduleTypeId="DeaccelerationOverLifetime";var he=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).strength=100,e}return Object(C.a)(n,[{key:"update",value:function(e){var t=this;this.particleEffect.particles.forEach((function(n){n.velocity.y+=t.strength*e}))}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,strength:this.strength}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"strength",B,a),r}}]),n}(k);he.moduleTypeId="Gravity";var ve=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).center={x:0,y:0},e.radius=50,e.nextParticleAngle=0,e.angleStep=.5,e}return Object(C.a)(n,[{key:"generateParticle",value:function(){var e=new ee;e.position.x=this.center.x+Math.cos(this.nextParticleAngle)*this.radius,e.position.y=this.center.y+Math.sin(this.nextParticleAngle)*this.radius,this.nextParticleAngle+=this.angleStep,this.particleEffect.addParticle(e)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,interval:this.interval,bursts:this.bursts,center:this.center,radius:this.radius,nextParticleAngle:this.nextParticleAngle,angleStep:this.angleStep}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"interval",B,a),D(t,n,r,"bursts",B,a),D(t,n,r,"center",B,a),D(t,n,r,"radius",B,a),D(t,n,r,"nextParticleAngle",B,a),D(t,n,r,"angleStep",B,a),r}}]),n}(te);ve.moduleTypeId="CircleLoadingGenerator";var be=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).edgesOnly=!1,e}return Object(C.a)(n,[{key:"generateParticle",value:function(){var e,t=new ee;this.shape&&(this.edgesOnly?t.position=(e=this.shape,Z(e).getRandomEdgePosition(e)):t.position=function(e){return Z(e).getRandomPosition(e)}(this.shape)),this.particleEffect.addParticle(t)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,interval:this.interval,bursts:this.bursts,shape:this.shape?this.shape:void 0,edgesOnly:this.edgesOnly}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"interval",B,a),D(t,n,r,"bursts",B,a),D(t,n,r,"shape",Q,a),D(t,n,r,"edgesOnly",B,a),r}}]),n}(te);be.moduleTypeId="ShapeGenerator";var je=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).strength=100,e.center={x:0,y:0},e.maxPullStrengthDistance=100,e.maxPullStrengthMultiplier=1,e.minPullStrengthDistance=500,e.minPullStrengthMultiplier=.25,e}return Object(C.a)(n,[{key:"update",value:function(e){var t=this,n=this.center;this.particleEffect.particles.forEach((function(a){var r=G.subtract(n,a.position),i=G.length(r),c=U(t.minPullStrengthMultiplier,t.maxPullStrengthMultiplier,V((i-t.minPullStrengthDistance)/(t.maxPullStrengthDistance-t.minPullStrengthDistance),0,1)),o=e*t.strength*c,s=G.normalize(r);a.velocity.x+=s.x*o,a.velocity.y+=s.y*o}))}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,strength:this.strength,center:this.center,maxPullStrengthDistance:this.maxPullStrengthDistance,maxPullStrengthMultiplier:this.maxPullStrengthMultiplier,minPullStrengthDistance:this.minPullStrengthDistance,minPullStrengthMultiplier:this.minPullStrengthMultiplier}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"strength",B,a),D(t,n,r,"center",B,a),D(t,n,r,"maxPullStrengthDistance",B,a),D(t,n,r,"maxPullStrengthMultiplier",B,a),D(t,n,r,"minPullStrengthDistance",B,a),D(t,n,r,"minPullStrengthMultiplier",B,a),r}}]),n}(k);je.moduleTypeId="GravityWithCenter";var ye=function(e){Object(R.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(S.a)(this,n),(e=t.apply(this,arguments)).min=0,e.max=2*Math.PI,e.handleParticleAdd=function(t){var n=Y(e.min,e.max);t.rotation=n},e}return Object(C.a)(n,[{key:"init",value:function(){this.particleEffect.addParticleListeners.push(this.handleParticleAdd)}},{key:"toObject",value:function(){return{moduleTypeId:n.moduleTypeId,min:this.min,max:this.max}}}],[{key:"fromObject",value:function(e,t,a){var r=new n(e);return D(t,n,r,"min",B,a),D(t,n,r,"max",B,a),r}}]),n}(k);ye.moduleTypeId="RandomRotation";var xe=[_,F,$,ne,ae,re,ie,le,me,pe,he,ce,oe,se,ve,be,je,ye],Oe=function(){function e(t){Object(S.a)(this,e),this.modules=[],this.particles=[],this.isInitialized=!1,this.textures=[],this.addParticleListeners=[],this.destroyParticleListeners=[],this.particleSystem=t}return Object(C.a)(e,[{key:"init",value:function(){this.modules.forEach((function(e){e.init()}))}},{key:"update",value:function(e){for(var t=this.particles.length,n=0;n<t;n+=1){var a=this.particles[n];a.timeLived+=e,a.position.x+=a.velocity.x*e,a.position.y+=a.velocity.y*e,a.rotation+=a.rotationalVelocity*e}this.modules.forEach((function(t){t.active&&t.update(e)}));for(var r=0;r<this.particles.length;r+=1){this.particles[r].destroyed&&(this.particles.splice(r,1),r-=1)}}},{key:"addParticle",value:function(e){this.particles.push(e),this.textures.length>0&&(e.texture=this.textures[Math.round(Math.random()*(this.textures.length-1))]),this.addParticleListeners.forEach((function(t){t(e)}))}},{key:"destroyParticle",value:function(e){e.destroyed=!0,this.destroyParticleListeners.forEach((function(t){t(e)}))}}],[{key:"fromObject",value:function(e,t,n){var a,r=(null===n||void 0===n?void 0:n.hideWarnings)||!1,i=e.addParticleEffect();return i.textures=t.textures,null===(a=t.modules)||void 0===a||a.forEach((function(e){var t=xe.find((function(t){return t.moduleTypeId===e.moduleTypeId}));if(t){var n=t.fromObject(i,e,r);i.modules.push(n)}else r||console.warn('fromObject unidentified module type: "'.concat(e.moduleTypeId,'"'))})),i}}]),e}(),ge=function(){function e(){Object(S.a)(this,e),this.effects=[],this.addParticleEffectListeners=[],this.removeParticleEffectListeners=[]}return Object(C.a)(e,[{key:"update",value:function(e){this.effects.forEach((function(t){t.isInitialized||(t.init(),t.isInitialized=!0),t.update(e)}))}},{key:"addParticleEffect",value:function(){var e=new Oe(this);return this.effects.push(e),this.addParticleEffectListeners.forEach((function(t){return t(e)})),e}},{key:"removeParticleEffect",value:function(e){var t=this.effects.indexOf(e);t<=0&&(this.effects.splice(t,1),this.removeParticleEffectListeners.forEach((function(t){return t(e)})))}},{key:"toObject",value:function(){return{effects:this.effects.map((function(e){return{textures:e.textures,modules:e.modules.map((function(e){return e.toObject()}))}}))}}}],[{key:"fromObject",value:function(t,n){var a=new e;return t.effects.forEach((function(e){Oe.fromObject(a,e,n)})),a}}]),e}(),Te=function(e){var t=e.effects,n=Object(a.useState)([]),r=Object(u.a)(n,2),i=r[0],c=r[1],o=Object(a.useState)(void 0),s=Object(u.a)(o,2),l=s[0],d=s[1],f=Object(a.useRef)(void 0),p=Object(a.useRef)(void 0);return Object(a.useEffect)((function(){var e=ge.fromObject({effects:t},{hideWarnings:!0});d(e);var n=t.map((function(e){return e.textures})).flat();c(n);var a=0,r=window.performance.now(),i=requestAnimationFrame((function t(){var n=window.performance.now(),c=(n-r)/1e3;a+=c,f.current&&(f.current.innerHTML="Run time ".concat(a.toFixed(2))),e.update(c);var o=e.effects.reduce((function(e,t){return e+t.particles.length}),0);p.current&&(p.current.innerHTML="Particles ".concat(o)),i=requestAnimationFrame(t),r=n}));return function(){cancelAnimationFrame(i),i=void 0}}),[t]),Object(a.useEffect)((function(){if(l){var e=document.getElementById("particleSandbox"),t={};i.forEach((function(e){var n=new Image;n.src="textures/".concat(e),t[e]=n}));var n=I({particleSystem:l,container:e,textures:t,coordinateSystem:"pixels-centered",autoUpdate:!1,loggingEnabled:!1});return function(){n.destroy()}}}),[l,i]),Object(m.jsxs)("div",{className:"particleSandbox",children:[Object(m.jsx)("div",{className:"particleSandbox-gridColumns",children:new Array(10).fill(0).map((function(e,t){return Object(m.jsx)("div",{className:"particleSandbox-gridColumn"},"col".concat(t))}))}),Object(m.jsx)("div",{className:"particleSandbox-gridRows",children:new Array(10).fill(0).map((function(e,t){return Object(m.jsx)("div",{className:"particleSandbox-gridRow"},"col".concat(t))}))}),Object(m.jsx)("div",{className:"particleSandbox-canvas",id:"particleSandbox"}),Object(m.jsxs)("div",{className:"particleSandbox-stats",children:[Object(m.jsx)("span",{ref:f,children:"Run time"}),Object(m.jsx)("span",{ref:p,children:"Particles"})]})]})},Pe=(n(36),{particleModules:[],easingFunctions:[],availableTextures:[],shapes:[],presetEffects:[]}),Ee=Object(a.createContext)(Pe),Ne=[{textures:["ball.png"],modules:[{moduleTypeId:"PointGenerator"},{moduleTypeId:"RandomAngleVelocity",min:50,max:100},{moduleTypeId:"RandomScale",min:.5,max:.8},{moduleTypeId:"RandomColor"},{moduleTypeId:"LifeTimeRange"},{moduleTypeId:"AlphaOverLifetime"},{moduleTypeId:"LifeTimeDestructor"}]}],Me=function(e,t){var n={textures:e.textures,modules:[]};return e.modules.forEach((function(e){var a=Object(o.a)({},e),r=t.find((function(t){return t.moduleTypeId===e.moduleTypeId}));Object.entries(r.properties).forEach((function(t){var n=Object(u.a)(t,2),r=n[0],i=n[1];if(void 0===a[r])if("defaultValue"in i){var c=i.defaultValue;if("Number"===i.type)try{c=Number(c)}catch(o){console.error("Number defaultValue parsing error ".concat(c))}else if("Boolean"===i.type)c="true"===c.toLowerCase();else if("EasingFunction"===i.type){if("string"!==typeof c)throw new Error("defaultValue parsing error ".concat(i.type," (").concat(c,")"))}else{if("Range"!==i.type&&"Burst[]"!==i.type&&"Position"!==i.type&&"Color[]"!==i.type&&"Shape"!==i.type)throw new Error("Unhandled defaultValue type: ".concat(i.type));try{c=JSON.parse(c)}catch(o){console.error("defaultValue parsing error ".concat(i.type," (").concat(c,")"))}}a[r]=c}else console.warn("Missing property @defaultValue ".concat(e.moduleTypeId,": ").concat(r))})),n.modules.push(a)})),n},Ae=function(e){var t=Object(a.useState)([]),n=Object(u.a)(t,2),r=n[0],i=n[1],c=Object(a.useState)(!0),o=Object(u.a)(c,2),d=o[0],p=o[1],h=Object(a.useContext)(Ee).particleModules;Object(a.useEffect)((function(){var e=fetch("config.modularParticleSystem.json").then((function(e){return e.json()})).then((function(e){console.log("loaded core library config");var t=e.particleModules,n=e.easingFunctions,a=e.shapes;Pe.particleModules=t,Pe.easingFunctions=n,Pe.shapes=a,i(Ne.map((function(e){return Me(e,t)})))})),t=fetch("config.textures.json").then((function(e){return e.json()})).then((function(e){console.log("loaded available textures"),Pe.availableTextures=e})),n=fetch("config.presetParticleEffects.json").then((function(e){return e.json()})).then((function(e){console.log("loaded preset effects"),Pe.presetEffects=e}));Promise.all([e,t,n]).then((function(e){p(!1)}))}),[]);var v=Object(a.useRef)(null);return d?Object(m.jsx)("div",{className:"editor-loading",children:"Loading..."}):Object(m.jsxs)(Ee.Provider,{value:Pe,children:[Object(m.jsxs)("div",{className:"editor",children:[Object(m.jsx)(M,{restart:function(){i(Object(l.a)(r))},saveToFile:function(){!function(e,t){var n=new Blob([JSON.stringify(e,null,2)],{type:"application/json;charset=utf-8"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}({effects:r.map((function(e){return{textures:e.textures,modules:e.modules}}))},"particleSystem.json")},loadPreset:function(e){i(e.effects)},loadFromFile:function(){var e=v.current;e&&e.click()}}),Object(m.jsxs)("div",{className:"editor-workspace",children:[Object(m.jsx)(Te,{effects:r}),Object(m.jsx)(N,{effects:r,updateEffects:function(e){e=e.map((function(e){return Me(e,h)})),i(e)}})]})]}),Object(m.jsx)("input",{className:"editor-fileInput",type:"file",ref:v,accept:".json",onChange:function(){var e=Object(s.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.target.files[0],e.next=4,new Response(n).json();case 4:a=e.sent,i(a.effects),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert("Unexpected error while loading file.\n".concat(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()})]})},we=(n(37),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))});c.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(Ae,{})}),document.getElementById("root")),we()}]),[[38,1,2]]]);
//# sourceMappingURL=main.9e058281.chunk.js.map